# Terraform module for ECS Task Definition
<!-- BEGINNING OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
## Requirements

No requirements.

## Providers

| Name | Version |
|------|---------|
| <a name="provider_aws"></a> [aws](#provider\_aws) | n/a |

## Modules

No modules.

## Resources

| Name | Type |
|------|------|
| [aws_ecs_service.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_service) | resource |
| [aws_ecs_task_definition.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition) | resource |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_alarms"></a> [alarms](#input\_alarms) | (Optional) A list of CloudWatch Alarms to monitor the service. The service will be created with the CloudWatch Alarms attached. The format is a list of maps, where each map should contain the following keys:<br>    - alarm\_names - (Required) The list of CloudWatch Alarm names to attach to the service.<br>    - enable - (Required) Enable the alarm. Default is true.<br>    - rollback - (Required) Rollback the service if the alarm is triggered. Default is false. | <pre>list(object({<br>    alarm_names = string<br>    enable      = string<br>    rollback    = string<br>  }))</pre> | `[]` | no |
| <a name="input_capacity_provider_strategy"></a> [capacity\_provider\_strategy](#input\_capacity\_provider\_strategy) | (Optional) The capacity provider strategy to use for the service. A capacity provider strategy consists of one or more capacity providers along with the base and weight to assign to them. A capacity provider must be associated with the cluster to be used in a capacity provider strategy. The PutClusterCapacityProviders API is used to update the list of available capacity providers for a cluster. Only capacity providers with an ACTIVE or UPDATING status can be used. If specifying a capacity provider that uses an Auto Scaling group, the capacity provider must already be created. New capacity providers can be created with the CreateCapacityProvider API operation. You can specify up to 10 capacity providers in one capacity provider strategy. Services can use multiple capacity providers in a strategy. You can specify up to 10 capacity providers in one capacity provider strategy.<br>    - base - (Optional) The base value designates how many tasks, at a minimum, to run on the specified capacity provider. Only one capacity provider in a capacity provider strategy can have a base defined. If no value is specified, the default value is 0.<br>    - capacity\_provider - (Required) The short name of the capacity provider.<br>    - weight - (Optional) The weight value designates the relative percentage of the total number of launched tasks that should use the specified capacity provider. The weight value is taken into consideration after the base value, if defined, is satisfied. | <pre>list(object({<br>    base              = optional(string)<br>    capacity_provider = string<br>    weight            = optional(string)<br>  }))</pre> | `[]` | no |
| <a name="input_cluster"></a> [cluster](#input\_cluster) | (Required) The name of the ECS cluster. | `string` | n/a | yes |
| <a name="input_container_definitions"></a> [container\_definitions](#input\_container\_definitions) | (Required) A list of valid container definitions provided as a single valid JSON document. Please note that you should only provide values that are part of the container definition document. For a detailed description of what parameters are available, see the Task Definition Parameters section from the official Developer Guide. | `any` | n/a | yes |
| <a name="input_cpu"></a> [cpu](#input\_cpu) | (Optional) Number of cpu units used by the task. If the requires\_compatibilities is FARGATE this field is required. | `number` | `null` | no |
| <a name="input_deployment_circuit_breaker"></a> [deployment\_circuit\_breaker](#input\_deployment\_circuit\_breaker) | (Optional) The deployment circuit breaker can be used to define a strategy to avoid deployment failures when a service is unable to reach a steady state. The deployment circuit breaker allows you to configure deployment maximum percent and minimum healthy percent. The deployment circuit breaker is only available to services using the rolling update (ECS) deployment type. The format is a list of maps, where each map should contain the following keys:<br>    - enable - (Required) Whether to enable the deployment circuit breaker. Default is false.<br>    - rollback - (Required) Whether to enable the rollback of the service if the deployment fails. Default is false. | <pre>list(object({<br>    enable   = string<br>    rollback = string<br>  }))</pre> | `[]` | no |
| <a name="input_deployment_controller"></a> [deployment\_controller](#input\_deployment\_controller) | (Optional) The deployment controller to use for the service. The deployment controller is used to determine the deployment strategy to use during a service deployment. The default value is ECS. The format is a list of maps, where each map should contain the following keys:<br>    - type - (Optional) The deployment controller type to use. Valid values are ECS and CODE\_DEPLOY. Default is ECS. | <pre>list(object({<br>    type = optional(string)<br>  }))</pre> | `[]` | no |
| <a name="input_deployment_maximum_percent"></a> [deployment\_maximum\_percent](#input\_deployment\_maximum\_percent) | (Optional) Upper limit (as a percentage of the service's desiredCount) of the number of running tasks that can be running in a service during a deployment. Not valid when using the DAEMON scheduling strategy. | `string` | `null` | no |
| <a name="input_deployment_minimum_healthy_percent"></a> [deployment\_minimum\_healthy\_percent](#input\_deployment\_minimum\_healthy\_percent) | (Optional) Lower limit (as a percentage of the service's desiredCount) of the number of running tasks that must remain running and healthy in a service during a deployment. | `number` | `null` | no |
| <a name="input_desired_count"></a> [desired\_count](#input\_desired\_count) | (Optional) Number of instances of the task definition to place and keep running. Defaults to 0. Do not specify if using the DAEMON scheduling strategy. | `number` | `null` | no |
| <a name="input_enable_ecs_managed_tags"></a> [enable\_ecs\_managed\_tags](#input\_enable\_ecs\_managed\_tags) | (Optional) Specifies whether to enable Amazon ECS managed tags for the tasks within the service. | `bool` | `true` | no |
| <a name="input_enable_execute_command"></a> [enable\_execute\_command](#input\_enable\_execute\_command) | (Optional) Specifies whether to enable Amazon ECS Exec for the tasks within the service. | `bool` | `false` | no |
| <a name="input_ephemeral_storage"></a> [ephemeral\_storage](#input\_ephemeral\_storage) | (Optional) The amount of ephemeral storage to allocate for the task. This parameter is used to expand the total amount of ephemeral storage available, beyond the default amount, for tasks hosted on Fargate. For more information, see Amazon ECS task storage.<br>    - size\_in\_gib - (Required) The total amount, in GiB, of ephemeral storage to set for the task. | <pre>list(object({<br>    size_in_gib = number<br>  }))</pre> | `[]` | no |
| <a name="input_execution_role_arn"></a> [execution\_role\_arn](#input\_execution\_role\_arn) | (Optional) ARN of the task execution role that the Amazon ECS container agent and the Docker daemon can assume. | `string` | `null` | no |
| <a name="input_family"></a> [family](#input\_family) | (Required) A unique name for your task definition. | `string` | n/a | yes |
| <a name="input_force_new_deployment"></a> [force\_new\_deployment](#input\_force\_new\_deployment) | (Optional) Enable to force a new task deployment of the service. This can be used to update tasks to use a newer Docker image with same image/tag combination (e.g., myimage:latest), roll Fargate tasks onto a newer platform version, or immediately deploy ordered\_placement\_strategy and placement\_constraints updates. | `bool` | `true` | no |
| <a name="input_health_check_grace_period_seconds"></a> [health\_check\_grace\_period\_seconds](#input\_health\_check\_grace\_period\_seconds) | (Optional) Seconds to ignore failing load balancer health checks on newly instantiated tasks to prevent premature shutdown, up to 2147483647. Only valid for services configured to use load balancers. | `number` | `null` | no |
| <a name="input_inference_accelerator"></a> [inference\_accelerator](#input\_inference\_accelerator) | (Optional) The Elastic Inference accelerator associated with the task. The parameter maps to DeviceName and DeviceType in the Amazon ECS task definition. For more information, see Working with Amazon ECS Elastic Inference Accelerators.<br>    - device\_name - (Required) The Elastic Inference accelerator device name. The deviceName must also be referenced in a container definition as a ResourceRequirement.<br>    - device\_type - (Required) The Elastic Inference accelerator type to use. | <pre>list(object({<br>    device_name = string<br>    device_type = string<br>  }))</pre> | `[]` | no |
| <a name="input_ipc_mode"></a> [ipc\_mode](#input\_ipc\_mode) | (Optional) IPC resource namespace to be used for the containers in the task The valid values are host, task, and none. | `string` | `null` | no |
| <a name="input_launch_type"></a> [launch\_type](#input\_launch\_type) | (Optional) Launch type on which to run your service. The valid values are EC2, FARGATE, and EXTERNAL. Defaults to EC2. Conflicts with capacity\_provider\_strategy | `string` | `"FARGATE"` | no |
| <a name="input_memory"></a> [memory](#input\_memory) | (Optional) Amount (in MiB) of memory used by the task. If the requires\_compatibilities is FARGATE this field is required. | `number` | `null` | no |
| <a name="input_network_mode"></a> [network\_mode](#input\_network\_mode) | (Optional) Docker networking mode to use for the containers in the task. Valid values are none, bridge, awsvpc, and host. | `string` | `null` | no |
| <a name="input_pid_mode"></a> [pid\_mode](#input\_pid\_mode) | (Optional) Process namespace to use for the containers in the task. The valid values are host and task. | `string` | `null` | no |
| <a name="input_placement_constraints"></a> [placement\_constraints](#input\_placement\_constraints) | (Optional) A set of placement constraints rules that are taken into consideration during task placement. Maximum number of placement\_constraints is 10.<br>    - expression - (Optional) A cluster query language expression to apply to the constraint. For more information, see Cluster Query Language in the Amazon Elastic Container Service Developer Guide.<br>    - type - (Required) The type of constraint. The valid values are distinctInstance, memberOf, and cardinality. | <pre>list(object({<br>    expression = optional(string)<br>    type       = string<br>  }))</pre> | `[]` | no |
| <a name="input_proxy_configuration"></a> [proxy\_configuration](#input\_proxy\_configuration) | (Optional) The configuration details for the App Mesh proxy.<br>    - container\_name - (Required) The name of the container that will serve as the App Mesh proxy.<br>    - properties - (Required) The set of network configuration parameters to provide the Container Network Interface (CNI) plugin, specified as key-value pairs.<br>    - type - (Optional) The proxy type. The default value is APPMESH. | <pre>list(object({<br>    container_name = string<br>    properties     = string<br>    type           = optional(string)<br>  }))</pre> | `[]` | no |
| <a name="input_requires_compatibilities"></a> [requires\_compatibilities](#input\_requires\_compatibilities) | (Optional) Set of launch types required by the task. The valid values are EC2 and FARGATE. | `list(string)` | <pre>[<br>  "FARGATE"<br>]</pre> | no |
| <a name="input_runtime_platform"></a> [runtime\_platform](#input\_runtime\_platform) | (Optional) The operating system family and the architecture of the operating system to use. The valid values are WINDOWS and LINUX. The default operating system is LINUX. The default architecture is x86\_64.<br>    - operating\_system\_family - (Optional) The operating system family to use. Valid values are WINDOWS or LINUX. The default value is LINUX.<br>    - cpu\_architecture - (Optional) The architecture of the operating system to use. The valid values are x86\_64 and arm64. The default value is x86\_64. | <pre>list(object({<br>    operating_system_family = optional(string)<br>    cpu_architecture        = optional(string)<br>  }))</pre> | `[]` | no |
| <a name="input_skip_destroy"></a> [skip\_destroy](#input\_skip\_destroy) | (Optional) Whether to retain the old revision when the resource is destroyed or replacement is necessary. Default is false. | `bool` | `false` | no |
| <a name="input_tags"></a> [tags](#input\_tags) | (Optional) Key-value map of resource tags. If configured with a provider default\_tags configuration block present, tags with matching keys will overwrite those defined at the provider-level. | `map(string)` | `{}` | no |
| <a name="input_task_role_arn"></a> [task\_role\_arn](#input\_task\_role\_arn) | (Optional) ARN of IAM role that allows your Amazon ECS container task to make calls to other AWS services. | `string` | `null` | no |
| <a name="input_track_latest"></a> [track\_latest](#input\_track\_latest) | (Optional) Whether should track latest task definition or the one created with the resource. Default is false. | `bool` | `false` | no |
| <a name="input_volume"></a> [volume](#input\_volume) | (Optional) A set of volume blocks that containers in your task may use.<br>    - name - (Required) The name of the volume. Up to 255 letters (uppercase and lowercase), numbers, hyphens, and underscores are allowed.<br>    - host\_path - (Optional) The path on the host container instance that is presented to the container. If the sourcePath value does not exist on the host container instance, the Docker daemon creates it. If the sourcePath value does exist, the contents of the source path folder are exported.<br>    - docker\_volume\_configuration - (Optional) The Docker volume configuration to use for the volume. This parameter maps to Volumes in the Create a container section of the Docker Remote API and the --volume option to docker run.<br>    - efs\_volume\_configuration - (Optional) The Amazon Elastic File System (Amazon EFS) volume configuration to use for the volume. This parameter maps to EFSVolumeConfiguration in the Amazon Elastic Container Service API.<br>    - fsx\_windows\_file\_server\_volume\_configuration - (Optional) The Amazon FSx for Windows File Server volume configuration to use for the volume. This parameter maps to FSxWindowsFileServerVolumeConfiguration in the Amazon Elastic Container Service API. | <pre>list(object({<br>    name      = string<br>    host_path = optional(string)<br>    docker_volume_configuration = optional(list(object({<br>      autoprovision = optional(bool)<br>      driver_opts   = optional(map(string))<br>      driver        = optional(string)<br>      labels        = optional(map(string))<br>      scope         = optional(string)<br>    })))<br>    efs_volume_configuration = optional(list(object({<br>      file_system_id          = string<br>      root_directory          = optional(string)<br>      transit_encryption      = optional(string)<br>      transit_encryption_port = optional(number)<br>      authorization_config = optional(list(object({<br>        access_point_id = string<br>        iam             = string<br>      })))<br>    })))<br>    fsx_windows_file_server_volume_configuration = optional(list(object({<br>      file_system_id = string<br>      root_directory = string<br>      authorization_config = list(object({<br>        credentials_parameter = string<br>        domain                = string<br>      }))<br>    })))<br>  }))</pre> | `[]` | no |

## Outputs

No outputs.
<!-- END OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
